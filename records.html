
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f9f9f9; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #eee; }
    button { margin-top: 10px; padding: 10px; }
  </style>
  <script>
    function loadData() {
      const data = JSON.parse(localStorage.getItem('generator_records') || '[]');
      const tbody = document.getElementById('data');
      tbody.innerHTML = "";
      data.forEach((row, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${index + 1}</td>
          <td>${row.timestamp.split('T')[0]}</td>
          <td>${row.name}</td>
          <td>${row.r}</td>
          <td>${row.s}</td>
          <td>${row.t}</td>
          <td>${row.status}</td>
          <td>${row.oil ? "‚úî" : ""}</td>
          <td>${row.coolant ? "‚úî" : ""}</td>
          <td>${row.battery ? "‚úî" : ""}</td>
          <td>${row.start}</td>
          <td>${row.stop}</td>
          <td>${row.note}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function exportToExcel() {
      const table = document.getElementById("reportTable").outerHTML;
      const blob = new Blob(["Ôªø", table], { type: "application/vnd.ms-excel" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "generator_report.xls";
      a.click();
    }

    function printPDF() {
      window.print();
    }

    window.onload = loadData;
  </script>
</head>
<body>
  <h1>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏±‡πà‡∏ô‡πÑ‡∏ü‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h1>
  <button onclick="exportToExcel()">üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel</button>
  <button onclick="printPDF()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
  <table id="reportTable">
    <thead>
      <tr>
        <th>#</th><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á</th><th>R</th><th>S</th><th>T</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th>‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</th><th>‡∏ô‡πâ‡∏≥‡∏´‡∏•‡πà‡∏≠‡πÄ‡∏¢‡πá‡∏ô</th><th>‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà</th>
        <th>‡πÄ‡∏£‡∏¥‡πà‡∏°</th><th>‡∏´‡∏¢‡∏∏‡∏î</th><th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
      </tr>
    </thead>
    <tbody id="data"></tbody>
  </table>
</body>
</html>
